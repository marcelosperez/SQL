-- Problem: List the department name, location, and total 
-- number of employees in that department. (INLINE VIEW)
-- Note: An inline view is a subquery in the FROM clause that is treated 
-- like a temporary table. This is useful for pre-aggregating data or simplifying complex joins
SELECT d.department_name, d.location_id,
            emp_count.total_employees
FROM hr.departments d,
  (
    SELECT department_id,
                COUNT(*) AS total_employees
    FROM  hr.employees
    GROUP BY department_id
  ) emp_count
WHERE d.department_id = emp_count.department_id;
